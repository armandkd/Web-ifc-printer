<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>WebGL 3D model viewer using three.js</title>
  <script src="include/three.js"></script>
  <script src="include/TrackballControls.js"></script>
  <script src="include/OBJLoader.js"></script>
  <script src="include/Detector.js"></script>
</head>
<body>

  <script>
    var container;
	var camera, scene, renderer;
	var mouseX = 0, mouseY = 0;

	var windowHalfX = window.innerWidth / 2;
	var windowHalfY = window.innerHeight / 2;

	init();
	animate();

	/*** Initialize ***/
	function init() {
	
	  // This <div> will host the canvas for our scene.
	  container = document.createElement( 'div' );
	  document.body.appendChild( container );

	  // Camera
	  camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 1, 2000 );
	  camera.position.z = 7;

	  // Controls
	  controls = new THREE.TrackballControls( camera );
	  controls.rotateSpeed = 5.0;
	  controls.zoomSpeed = 5;
	  controls.panSpeed = 2;
	  controls.noZoom = false;
	  controls.noPan = false;
	  controls.staticMoving = true;
	  controls.dynamicDampingFactor = 0.3;

	  // New scene
	  scene = new THREE.Scene();

	  // Lights
	  var ambient = new THREE.AmbientLight( 0xff00ff );
	  scene.add( ambient );

	  // A simple directional light
	  var directionalLight = new THREE.DirectionalLight( 0xffeedd );
	  directionalLight.position.set( 10, 10, 50 ).normalize();
	  scene.add( directionalLight );
	  
	  var directionalLight1 = new THREE.DirectionalLight( 0x00ee00 );
	  directionalLight1.position.set( -10, -10, -50 ).normalize();
	  scene.add( directionalLight1 );
	  
	  
	/*====================LOADING_FILE====================*/
	  
	  /*** Texture Loading ***/
	  var manager = new THREE.LoadingManager();
	  manager.onProgress = function ( item, loaded, total ) {
		console.log( item, loaded, total );
	  };
	  var texture = new THREE.Texture();
	  var loader = new THREE.ImageLoader( manager );

	  // You can set the texture properties in this function. 
	  // The string has to be the path to your texture file.
	  loader.load( 'data/tex2.png', function ( image ) {
		texture.image = image;
		texture.needsUpdate = true;
		// I wanted a nearest neighbour filtering for my low-poly character,
		// so that every pixel is crips and sharp. You can delete this lines
		// if have a larger texture and want a smooth linear filter.
		texture.magFilter = THREE.NearestFilter;
		texture.minFilter = THREE.NearestMipMapLinearFilter;
	  } );

	  /*** OBJ Loading ***/
	  var loader = new THREE.OBJLoader( manager );

	  // As soon as the OBJ has been loaded this function looks for a mesh
	  // inside the data and applies the texture to it.
	  loader.load( 'data/model.obj', function ( event ) {
		var object = event;
		object.traverse( function ( child ) {
		  if ( child instanceof THREE.Mesh ) {
			child.material.map = texture;
		  }
		} );

		// My initial model was too small, so I scaled it upwards.
		object.scale = new THREE.Vector3( 2, 2, 2 );

		// You can change the position of the object, so that it is not
		// centered in the view and leaves some space for overlay text.
		object.position.y -= scene.position.y;
		scene.add( object );
	  });

	  // We set the renderer to the size of the window and
	  // append a canvas to our HTML page.
	  renderer = new THREE.WebGLRenderer();
	  renderer.setSize( window.innerWidth, window.innerHeight );
	  container.appendChild( renderer.domElement );
	}
	  var theta = 0.0;
	  
	/*===============================================================*/

	/*** The Loop ***/
	function animate() {
	  // This function calls itself on every frame. You can for example change
	  // the objects rotation on every call to create a turntable animation.
	  requestAnimationFrame( animate );
		
	  theta += 0.5;
	  /*var radius = 20;

				camera.position.x = radius * Math.sin( THREE.Math.degToRad( theta ) );
				camera.position.y = 0;
				camera.position.z = radius * Math.cos( THREE.Math.degToRad( theta ) );
				camera.lookAt( scene.position );*/
	  
	  // On every frame we need to calculate the new camera position
	  // and have it look exactly at the center of our scene.
	  controls.update();
	  camera.lookAt(scene.position);
	  renderer.render(scene, camera);
	}
  </script>

</body>
</html>